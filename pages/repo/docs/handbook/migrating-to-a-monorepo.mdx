import Callout from "../../../../components/Callout";

# 迁移到 Monorepo


从 multi-repo 迁移到 monorepo 可以为工作效率带来巨大的好处，尤其是在以下情况下：

- 当你发现很难在应用程序之间共享代码
- 希望团队采用统一的方式构建代码

迁移到 monorepo 可能会有点困难，但是不要慌，稳住能赢。

## 文件夹结构

multi-repo 可能长这样：

```
web (repo 1)
├─ package.json

docs (repo 2)
├─ package.json

app (repo 3)
├─ package.json
```

有 3 个代码库, `web`, `docs` and `app`。它们没有共享的依赖，但是它们之间有很多重复的代码。

迁移成 monorepo 的话文件夹结构推荐是这样：

```
my-monorepo
├─ apps
│  ├─ app
│  │  └─ package.json
│  ├─ docs
│  │  └─ package.json
│  └─ web
│     └─ package.json
└─ package.json
```
为了更好的代码复用，可以创建一个[内部使用的包](/repo/docs/handbook/sharing-code/internal-packages)，所以就会有一个新的文件夹 `packages`

```
my-monorepo
├─ apps
│  ├─ app
│  │  └─ package.json
│  ├─ docs
│  │  └─ package.json
│  └─ web
│     └─ package.json
├─ packages
│  └─ shared
│     └─ package.json
└─ package.json
```

<Callout type="idea">
  提示：如果你要迁移到 monorepo，先构思一下你的文件夹结构草图
</Callout>

## 设置工作区

文件夹结构有了之后，接下来就是设置工作区配置并且安装依赖，参见 [设置工作区](/repo/docs/handbook/workspaces)

## 任务处理

现在工作空间已经设置好了，你需要弄清楚如何在新的 monorepo 中运行任务。我们将介绍以下内容：

1. 用 Turborepo [设置任务](/repo/docs/core-concepts/running-tasks).
1. 设置 [dev 任务](/repo/docs/handbook/dev)
1. [lint](/repo/docs/handbook/linting)
1. [build](/repo/docs/handbook/building-your-app)
1. [test](/repo/docs/handbook/testing)
